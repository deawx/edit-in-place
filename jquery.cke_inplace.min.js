/**
 * @name CKEditor edit in place 
 * @version 2.1 (7 July 2014)
 * @author Earthchie (http://www.earthchie.com/)
 * @require JQuery 1.8 or newer
 *
 * @license WTFPL v.2 - http://www.wtfpl.net/
 */
$(function(){$("head").append("<style>.ckeip-container .ckeip-hover{display:none}.ckeip-container:hover .ckeip-hover{display:block}</style>");$(".simple-toolbar.editable").editable({cke_options:{toolbar:[["Bold","Italic","Underline"],["Maximize"]]}});$(".normal-toolbar.editable").editable({cke_options:{toolbar:[["Bold","Italic","Underline","Strike","Subscript","Superscript"],["JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"],["NumberedList","BulletedList"],["TextColor","BGColor"],["RemoveFormat"],["Format","Font","FontSize"],["Outdent","Indent"],["Link","Unlink","-","ShowBlocks"],"/",["NewPage"],["Image","Flash","Table","HorizontalRule","Smiley","SpecialChar"],["Cut","Copy","Paste","PasteText","PasteFromWord"],["Undo","Redo","-","Source","-","Maximize"]]}});$(".no-toolbar.editable").editable({cke_options:{removePlugins:"toolbar,elementspath",contentsCss: 'body{font-family:helvetical,arial,sans-serif;overflow:hidden;padding:0;margin:4px;}',resize_enabled: false,height:50}});$(".editable,[contenteditable=true]").editable()});var _ckeip={};var _ckeip_bkup={};var _ckeip_options={};var _ckeip_fn_prepare_hover=function(e){return'<div class="ckeip-hover" style="'+"position: absolute;"+"background: "+_ckeip_options[e].hover_background+";"+"color: "+_ckeip_options[e].hover_color+";"+"padding: "+_ckeip_options[e].hover_padding+";"+"font-size: "+_ckeip_options[e].hover_font_size+";"+"line-height: "+_ckeip_options[e].hover_line_height+";"+"top: "+_ckeip_options[e].hover_top+";"+"left: "+_ckeip_options[e].hover_left+";"+'">'+_ckeip_options[e].hover_text+"</div>"};$.fn.editable=function(e){$(this).each(function(){if(!$(this).parent().hasClass("ckeip-container")){var t="ckeip-"+(Math.random()+1).toString().replace(".","").substring(0,5);$(this).wrap('<div id="'+t+'" class="ckeip-container" style="position:relative;"></div>');_ckeip_options[t]=$.extend({ajax_var_name:"content",ajax_url:false,ajax_success:function(e){},ajax_error:function(e){},callback_save:function(){},callback_cancel:function(){},placeholder_text:"Double click to edit",placeholder_color:"grey",button_save_label:"Save",button_loading_label:"Please Wait",button_save_class:"",button_cancel_label:"Cancel",button_cancel_class:"",hover_text:"Double click to edit",hover_background:"rgba(0,0,0,.9)",hover_color:"#fff",hover_top:"-2.5em",hover_left:"0",hover_padding:"0.5em",hover_font_size:"0.7em",hover_line_height:"1em",cke_options:{height:$(this).outerHeight()+100}},e);$(this).addClass("ckeip");if($(this).attr("contenteditable")=="true"){$(this).attr("data-contenteditable","true");$(this).removeAttr("contenteditable")}if($(this).html()==""){$(this).html('<span class="ckeip-placeholder" style="color:'+_ckeip_options[t].placeholder_color+';font-style:italic;">'+_ckeip_options[t].placeholder_text+"</span>")}$(this).parent().append(_ckeip_fn_prepare_hover(t));$(this).parent().dblclick(function(){var e=$(this).attr("id");var t=$(this).find(".ckeip");t.find(".ckeip-placeholder").remove();_ckeip_bkup[e]=t.html();_ckeip[e]=CKEDITOR.replace(t.get(0),_ckeip_options[e].cke_options);var n='<div style="text-align:right;">'+'<button class="ckeip-save">'+_ckeip_options[e].button_save_label+"</button>&nbsp;"+'<button class="ckeip-cancel">'+_ckeip_options[e].button_cancel_label+"</button>"+"</div>";$(this).append(n);$(this).find(".ckeip-save").addClass(_ckeip_options[e].button_save_class);$(this).find(".ckeip-cancel").addClass(_ckeip_options[e].button_cancel_class);$(this).find(".ckeip-hover").remove();$(this).find(".ckeip-save").click(function(){var e=$(this);var t=$(this).parent().parent();var n=t.attr("id");var r=t.find(".ckeip");if(r.data("handler")){_ckeip_options[n].ajax_url=r.data("handler")}if(_ckeip_options[n].ajax_url){var i={};i[_ckeip_options[n].ajax_var_name]=_ckeip[n].getData();$(this).text(_ckeip_options[n].button_loading_label);$(this).attr("disabled","");$.ajax({type:"POST",url:_ckeip_options[n].ajax_url,data:i}).done(function(i){if(typeof _ckeip_options[n].ajax_success=="function"){_ckeip_options[n].ajax_success(i)}_ckeip[n].destroy();if(r.html()==""){r.html('<span class="ckeip-placeholder" style="color:'+_ckeip_options[n].placeholder_color+';font-style:italic;">'+_ckeip_options[n].placeholder_text+"</span>")}e.parent().remove();t.append(_ckeip_fn_prepare_hover(n))}).fail(function(e){if(typeof _ckeip_options[n].ajax_error=="function"){_ckeip_options[n].ajax_error(e)}}).always(function(t){e.text(_ckeip_options[n].button_save_label);e.removeAttr("disabled");if(typeof _ckeip_options[n].callback_save=="function"){_ckeip_options[n].callback_save(t)}})}else{_ckeip[n].destroy();if(r.html()==""){r.html('<span class="ckeip-placeholder" style="color:'+_ckeip_options[n].placeholder_color+';font-style:italic;">'+_ckeip_options[n].placeholder_text+"</span>")}$(this).parent().remove();t.append(_ckeip_fn_prepare_hover(n));if(typeof _ckeip_options[n].callback_save=="function"){_ckeip_options[n].callback_save()}}});$(this).find(".ckeip-cancel").click(function(){var e=$(this).parent().parent();var t=e.attr("id");var n=e.find(".ckeip");_ckeip[t].destroy();n.html(_ckeip_bkup[t]);if(n.html()==""){n.html('<span class="ckeip-placeholder" style="color:'+_ckeip_options[t].placeholder_color+';font-style:italic;">'+_ckeip_options[t].placeholder_text+"</span>")}$(this).parent().remove();e.append(_ckeip_fn_prepare_hover(t));if(typeof _ckeip_options[t].callback_cancel=="function"){_ckeip_options[t].callback_cancel()}})})}})};$.fn.not_editable=function(e){$(this).each(function(){if($(this).parent().hasClass("ckeip-container")){if($(this).attr("data-contenteditable")=="true"){$(this).attr("contenteditable","true");$(this).removeAttr("data-contenteditable")}var e=$(this).parent().attr("id");$(this).parent().find(".ckeip-cancel").trigger("click");$(this).removeClass("ckeip");$(this).find(".ckeip-placeholder").remove();$(this).parent().before($(this).get(0).outerHTML);$(this).parent().remove()}})}